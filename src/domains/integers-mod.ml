IntegersMod  p Int    FIELD  struct let  intype Numberlet rec normalize(n) n mod plet  inlet  inexception let rec  ~(n) - (p,  , n)let rec  +(m,  , n) normalize (+ (m,  , n))let rec  -(m,  , n) normalize (- (m,  , n))let rec  *(m,  , n) normalize (* (m,  , n))let rec inverse(0) raise (div) inverse(n) let (* alternative: compute n^(p-2) *)
let rec inverse'i if (normalize (* (n,  , i)) = 1) then i else inverse' (+ (i,  , 1)) in inverse' 1let rec fromInt(n) normalize (n)let rec fromString(str) let let  in in if check (explode str) then (match (fromString (str)) with sOME (n) -> if (n < p) then sOME (n) else nONE nONE -> nONE) else nONElet  inend