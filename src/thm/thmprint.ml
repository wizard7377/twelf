ThmPrint  ThmSyn' THMSYN    Formatter FORMATTER     THMPRINT  struct module module module module let rec fmtIdsnil [] fmtIds(n :: nil) [string (n)] fmtIds(n :: l) [string (n); string " "] @ (fmtIds l)let rec fmtParamsnil [] fmtParams(sOME n :: nil) [string (n)] fmtParams(nONE :: nil) [string ("_")] fmtParams(sOME n :: l) [string (n); string " "] @ (fmtParams l) fmtParams(nONE :: l) [string ("_"); string " "] @ (fmtParams l)let rec fmtType(c,  , l) hVbox ([string (conDecName (sgnLookup c)); string " "] @ (fmtParams l))let rec fmtCallpatsnil [] fmtCallpats(t :: nil) [string "("; fmtType t; string ")"] fmtCallpats(t :: l) [string "("; fmtType t; string ") "] @ (fmtCallpats l)let rec fmtOptions(l as (_ :: nil)) [hVbox (fmtIds l)] fmtOptionsl [string "("; hVbox (fmtIds l); string ") "]let rec fmtOrder(varg l) (match l with (h :: nil) -> (fmtIds l) _ -> [string "("; hVbox (fmtIds l); string ")"]) fmtOrder(lex l) [string "{"; hVbox (fmtOrders l); string "}"] fmtOrder(simul l) [string "["; hVbox (fmtOrders l); string "]"] fmtOrdersnil nil fmtOrders(o :: nil) fmtOrder o fmtOrders(o :: l) fmtOrder o @ (string " " :: fmtOrders l)let rec tDeclToString(tDecl (o,  , callpats l)) makestring_fmt (hVbox (fmtOrder o @ (string " " :: fmtCallpats l)))let rec callpatsToString(callpats l) makestring_fmt (hVbox (fmtCallpats l))(* -bp *)
let rec fmtROrder(redOrder (p,  , o,  , o')) match p with less -> (fmtOrder o) @ (string " < " :: fmtOrder o') leq -> (fmtOrder o) @ (string " <= " :: fmtOrder o') eq -> (fmtOrder o) @ (string " = " :: fmtOrder o')let rec rOrderToStringr makestring_fmt (hVbox (fmtROrder r))let rec rDeclToString(rDecl (r,  , callpats l)) makestring_fmt (hVbox ((fmtROrder r @ (string " " :: fmtCallpats l))))let rec tabledDeclToString(tabledDecl cid) makestring_fmt (hVbox ([string (conDecName (sgnLookup cid))]))let rec keepTableDeclToString(keepTableDecl cid) makestring_fmt (hVbox ([string (conDecName (sgnLookup cid))]))let  inlet  inlet  in(* -bp *)
let  in(* -bp *)
let  inlet  in(* local *)
end