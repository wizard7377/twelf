ModePrint  Names NAMES    Formatter FORMATTER    Print PRINT    Print Formatter  Formatter    MODEPRINT  struct (* structure ModeSyn = ModeSyn' *)
module module module module let rec modeToStringplus "+" modeToStringstar "*" modeToStringminus "-" modeToStringminus1 "-1"let rec argToString(marg (m,  , _)) modeToString mlet rec nameDec(dec (_,  , v),  , marg (_,  , name as sOME _)) dec (name,  , v) nameDec(d,  , marg (_,  , nONE)) dlet rec makeSpine(g) let let rec makeSpine'(null,  , _,  , s) s makeSpine'(decl (g,  , _),  , k,  , s) makeSpine' (g,  , k + 1,  , app (root (bVar k,  , nil),  , s)) in makeSpine' (g,  , 1,  , nil)let rec fmtModeDec(cid,  , mS) let let  inlet rec fmtModeDec'(g,  , _,  , mnil) [string "("; formatExp (g,  , root (const (cid),  , makeSpine g)); string ")"] fmtModeDec'(g,  , pi ((d,  , _),  , v'),  , mapp (marg,  , s)) let let  inlet  in in [string (argToString marg); string "{"; formatDec (g,  , d''); string "}"; break] @ (fmtModeDec' (decl (g,  , d''),  , v',  , s)) in hVbox (fmtModeDec' (null,  , v,  , mS))let rec fmtModeDecs((cid,  , mS) :: nil) fmtModeDec (cid,  , mS) :: nil fmtModeDecs((cid,  , mS) :: mdecs) fmtModeDec (cid,  , mS) :: break :: fmtModeDecs mdecslet rec modeToStringcM makestring_fmt (fmtModeDec cM)let rec modesToStringmdecs makestring_fmt (vbox0 0 1 (fmtModeDecs mdecs))let  inlet  in(* local *)
end